import{S as s,i as a,s as e,j as t,m as r,o as n,x as o,u as c,v as i,k as l,e as f,t as u,n as m,V as d,c as h,d as v,a as p,g as w,b as g,f as E,E as $,H as k,w as b,r as j}from"../../chunks/vendor-23c8162e.js";import{a as y,n as I}from"../../chunks/Noti-91c2ae11.js";import{T as N}from"../../chunks/Tabs-c7f83f7f.js";import{L as S}from"../../chunks/LoadingSpinner-fa8d942c.js";import"../../chunks/variables-e34b2610.js";import"../../chunks/stores-36a9b970.js";function A(s){let a,e;return a=new S({}),{c(){t(a.$$.fragment)},l(s){r(a.$$.fragment,s)},m(s,t){n(a,s,t),e=!0},i(s){e||(o(a.$$.fragment,s),e=!0)},o(s){c(a.$$.fragment,s),e=!1},d(s){i(a,s)}}}function D(s){let a,e,y,I,S,D,L,T,V,x,U,H,M,P,O,R,B,C,F,G,_,q,z,J,K;a=new N({});let Q=s[0]&&A();return{c(){t(a.$$.fragment),e=l(),Q&&Q.c(),y=l(),I=f("meta"),S=l(),D=f("div"),L=f("div"),T=f("div"),V=f("header"),x=f("h3"),U=u("Email Notifications"),H=l(),M=f("small"),P=u("Select notification settings below, all optional"),O=l(),R=f("div"),B=f("form"),C=f("div"),F=f("input"),G=l(),_=f("label"),q=u("New User"),this.h()},l(s){r(a.$$.fragment,s),e=m(s),Q&&Q.l(s),y=m(s);const t=d('[data-svelte="svelte-183ffmf"]',document.head);I=h(t,"META",{name:!0,content:!0}),t.forEach(v),S=m(s),D=h(s,"DIV",{class:!0});var n=p(D);L=h(n,"DIV",{class:!0});var o=p(L);T=h(o,"DIV",{class:!0});var c=p(T);V=h(c,"HEADER",{class:!0});var i=p(V);x=h(i,"H3",{});var l=p(x);U=w(l,"Email Notifications"),l.forEach(v),H=m(i),M=h(i,"SMALL",{});var f=p(M);P=w(f,"Select notification settings below, all optional"),f.forEach(v),i.forEach(v),O=m(c),R=h(c,"DIV",{class:!0});var u=p(R);B=h(u,"FORM",{class:!0});var g=p(B);C=h(g,"DIV",{class:!0});var E=p(C);F=h(E,"INPUT",{id:!0,type:!0,class:!0}),G=m(E),_=h(E,"LABEL",{for:!0,class:!0});var $=p(_);q=w($,"New User"),$.forEach(v),E.forEach(v),g.forEach(v),u.forEach(v),c.forEach(v),o.forEach(v),n.forEach(v),this.h()},h(){document.title="Admin Settings",g(I,"name","robots"),g(I,"content","noindex, nofollow"),g(V,"class","card-header"),g(F,"id","option1"),g(F,"type","checkbox"),F.value="user",F.checked=s[1],g(F,"class","svelte-1wwt7fj"),g(_,"for","option1"),g(_,"class","svelte-1wwt7fj"),g(C,"class","inputGroup svelte-1wwt7fj"),g(B,"class","form svelte-1wwt7fj"),g(R,"class","card-body"),g(T,"class","card is-6"),g(L,"class","columns is-centered"),g(D,"class","container")},m(t,r){n(a,t,r),E(t,e,r),Q&&Q.m(t,r),E(t,y,r),$(document.head,I),E(t,S,r),E(t,D,r),$(D,L),$(L,T),$(T,V),$(V,x),$(x,U),$(V,H),$(V,M),$(M,P),$(T,O),$(T,R),$(R,B),$(B,C),$(C,F),$(C,G),$(C,_),$(_,q),z=!0,J||(K=k(F,"change",s[2]),J=!0)},p(s,[a]){s[0]?Q?1&a&&o(Q,1):(Q=A(),Q.c(),o(Q,1),Q.m(y.parentNode,y)):Q&&(j(),c(Q,1,1,(()=>{Q=null})),b()),(!z||2&a)&&(F.checked=s[1])},i(s){z||(o(a.$$.fragment,s),o(Q),z=!0)},o(s){c(a.$$.fragment,s),c(Q),z=!1},d(s){i(a,s),s&&v(e),Q&&Q.d(s),s&&v(y),v(I),s&&v(S),s&&v(D),J=!1,K()}}}async function L({session:s}){return s.user&&"admin"===s.user.role&&s.authenticated?{props:{token:s.token,user:s.user}}:{status:302,redirect:"/"}}function T(s,a,e){let t,r,{token:n}=a,{user:o}=a,c=!0;return(async()=>{const s=await y("POST",`user/settings/${o.username}`,{},n);if(s.status>=400)throw e(0,c=!1),new Error(s.message);return e(0,c=!1),r=s._id,e(1,t=s.settings.newUser)})().catch((s=>{e(0,c=!1),I.push(s.message)})),s.$$set=s=>{"token"in s&&e(3,n=s.token),"user"in s&&e(4,o=s.user)},[c,t,async function(s){"user"===s.target.value&&e(1,t=!t);const a={newUser:t,userId:r};try{const s=await y("PATCH","admin/update-settings",a,n);if(s.status>=400)throw new Error(s.message)}catch(o){I.push(o.message)}},n,o]}class V extends s{constructor(s){super(),a(this,s,T,D,e,{token:3,user:4})}}export{V as default,L as load};
